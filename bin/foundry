#!/usr/bin/env bash

set -euo pipefail

SELF_PATH="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)/$(basename "${BASH_SOURCE[0]}")"

if command -v foundry >/dev/null 2>&1; then
  FOUND_BIN="$(command -v foundry)"
  if [ "$(readlink -f "${FOUND_BIN}")" != "$(readlink -f "${SELF_PATH}")" ]; then
    exec foundry "$@"
  fi
fi

echo "foundry CLI is required but not installed." >&2
echo "Install: https://github.com/alflag-team/foundry" >&2
echo "Then run: foundry --root \"$(pwd)\" --overlay \"/path/to/private/overlay\" doctor" >&2
exit 127
